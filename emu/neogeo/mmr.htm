<!--
 ____________________________________________________________
|                                                            |
|    DESIGN + Pat Heard { http://fullahead.org }             |
|      DATE + 2006.09.12                                     |
| COPYRIGHT + Free use if this notice is kept in place.      |
|____________________________________________________________|

-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>司徒的教學網站</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-lowast="content-type" content="application/xhtml+xml; charset=UTF-8" />
  <meta name="author" content="fullahead.org" />
  <meta name="keywords" content="XHTML, CSS, template, FullAhead" />
  <meta name="description" content="A valid, XHTML 1.0 template" />
  <meta name="robots" content="index, follow, noarchive" />
  <meta name="googlebot" content="noarchive" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.1, maximum-scale=100.0"/>

  <link rel="shortcut icon" href="../../website.ico">
  <link rel="stylesheet" type="text/css" href="../../styles/shCore.css" />
  <link rel="stylesheet" type="text/css" href="../../styles/shThemeDefault.css" />
  <link rel="stylesheet" type="text/css" href="../../css/html.css" media="screen, projection, tv " />
  <link rel="stylesheet" type="text/css" href="../../css/layout.css" media="screen, projection, tv" />
  <link rel="stylesheet" type="text/css" href="../../css/print.css" media="print" />
  
  <script type="text/javascript" src="../../scripts/shCore.js"></script>
  <script type="text/javascript" src="../../scripts/shBrushCpp.js"></script>

  <!-- Conditional comment to apply opacity fix for IE #content background.
       Invalid CSS, but can be removed without harming design -->
  <!--[if gt IE 5]>
  <link rel="stylesheet" type="text/css" href="css/ie.css" media="screen, projection, tv " />
  <![endif]-->
</head>

<body>
<script type="text/javascript">SyntaxHighlighter.all();</script>
<div id="wrapper">
<div id="content">
<script type="text/javascript" src="../../header.js"></script>
<div id="page">
<h3>Neo Geo</h3>
<p><b>Memory Mapped Registers</b></p>
<hr size="1">
<p>
參考資訊：<br>
1. <a href="https://wiki.neogeodev.org/index.php?title=Main_Page">wiki</a><br><br>

I/O registers
</p>
<table>
<tr>
<th>Name</th>
<th>Address</th>
<th>Mask</th>
<th>Description</th>
<th>Read</th>
<th>Write</th>
</tr>

<tr>
<td>REG_P1CNT</td>
<td>0x300000</td>
<td>0xfe0001</td>
<td>Joypad port 1 inputs (active low)</td>
<td>
b7: D<br>
b6: C<br>
b5: B<br>
b4: A<br>
b3: RIGHT<br>
b2: LEFT<br>
b1: DOWN<br>
b0: UP
</td>
<td></td>
</tr>

<tr>
<td>REG_DIPSW</td>
<td>0x300001</td>
<td>0xfe0081</td>
<td>Hardware DIPs (active low)</td>
<td>
b7: Freeze<br>
b6: Freeplay<br>
b5: Enable Multiplayer<br>
b4~b3: Comm. ID code<br>
b2: [0]Normal controller, [1]Mahjong keyboard<br>
b1: [0]1 chute, [1]2 chutes<br>
b0: Settings mode
</td>
<td>Kick watchdog</td>
</tr>

<tr>
<td>REG_SYSTYPE</td>
<td>0x300081</td>
<td>0xfe0081</td>
<td>Reads the unused DSW2 on MV4 boards.<br>Used for system ID on other boards.</td>
<td>
b7: Test Button<br>
b6: Type [0]2 slots, [1]4 or 6 slots
</td>
<td></td>
</tr>

<tr>
<td>REG_SOUND</td>
<td>0x320000</td>
<td>0xfe0001</td>
<td></td>
<td>
Read Z80 reply code
</td>
<td>Send command to Z80</td>
</tr>

<tr>
<td>REG_STATUS_A</td>
<td>0x320001</td>
<td>0xfe0001</td>
<td>Switch inputs are active low</td>
<td>
b7: RTC data bit<br>
b6: RTC time pulse<br>
b5: [0]4-SLOT, [1]6-SLOT<br>
b4: Coin-in 4<br>
b3: Coin-in 3<br>
b2: Service button<br>
b1: Coin-in 2<br>
b0: Coin-in 1<br>
</td>
<td></td>
</tr>

<tr>
<td>REG_P2CNT</td>
<td>0x340000</td>
<td>0xfe0001</td>
<td>Joypad port 2 inputs (active low)</td>
<td>
b7: D<br>
b6: C<br>
b5: B<br>
b4: A<br>
b3: RIGHT<br>
b2: LEFT<br>
b1: DOWN<br>
b0: UP<br>
</td>
<td></td>
</tr>

<tr>
<td>REG_STATUS_B</td>
<td>0x380000</td>
<td>0xfe0001</td>
<td>Aux inputs (lower bits active low)</td>
<td>
b7: [0]AES, [1]MVS<br>
b6: Memory card write protected if 1<br>
b5~b4: Memory card inserted if 00<br>
b3: Select P2<br>
b2: Start P2<br>
b1: Select P1<br>
b0: Start P1<br>
</td>
<td></td>
</tr>

<tr>
<td>REG_POUTPUT</td>
<td>0x380001</td>
<td>0xfe0071</td>
<td>Joypad ports outputs</td>
<td>
b5~b3: P2 outputs<br>
b2~b0: P1 outputs<br>
</td>
<td></td>
</tr>

<tr>
<td>REG_CRDBANK</td>
<td>0x380011</td>
<td>0xfe0071</td>
<td></td>
<td>
</td>
<td>
b2~b0: Memory card bank selection
</td>
</tr>

<tr>
<td>REG_SLOT</td>
<td>0x380021</td>
<td>0xfe00f1</td>
<td>Mirror of REG_POUTPUT on the AES</td>
<td>
</td>
<td>
b2~b0: Slot #
</td>
</tr>

<tr>
<td>REG_LEDLATCHES</td>
<td>0x380031</td>
<td>0xfe00f1</td>
<td>LED data is latched on 1 to 0 transition.</td>
<td>
</td>
<td>
b5: Latch LED2 data<br>
b4: Latch LED1 data<br>
b3: Latch marquee data
</td>
</tr>

<tr>
<td>REG_LEDDATA</td>
<td>0x380041</td>
<td>0xfe00f1</td>
<td></td>
<td>
</td>
<td>
8-bit data for credits displays and the marquee.
</td>
</tr>

<tr>
<td>REG_RTCCTRL</td>
<td>0x380051</td>
<td>0xfe00f1</td>
<td>MAME upd4990a_control_16_w</td>
<td>
</td>
<td>
b2: RTC Strobe<br>
b1: RTC Clock<br>
b0: RTC DIN
</td>
</tr>

<tr>
<td>REG_RESETCC1</td>
<td>0x380061</td>
<td>0xfe00f1</td>
<td></td>
<td>
</td>
<td>
Any, coin counter 1 floats
</td>
</tr>

<tr>
<td>REG_RESETCC2</td>
<td>0x380063</td>
<td>0xfe00f1</td>
<td></td>
<td>
</td>
<td>
Any, coin counter 2 floats
</td>
</tr>

<tr>
<td>REG_RESETCL1</td>
<td>0x380065</td>
<td>0xfe00f1</td>
<td></td>
<td>
</td>
<td>
Any, coin lockout 1 floats
</td>
</tr>

<tr>
<td>REG_RESETCL2</td>
<td>0x380067</td>
<td>0xfe00f1</td>
<td></td>
<td>
</td>
<td>
Any, coin lockout 2 floats
</td>
</tr>

<tr>
<td>REG_SETCC1</td>
<td>0x3800e1</td>
<td>0xfe00f1</td>
<td></td>
<td>
</td>
<td>
Any, coin counter 1 sinks current
</td>
</tr>

<tr>
<td>REG_SETCC2</td>
<td>0x3800e3</td>
<td>0xfe00f1</td>
<td></td>
<td>
</td>
<td>
Any, coin counter 2 sinks current
</td>
</tr>

<tr>
<td>REG_SETCL1</td>
<td>0x3800e5</td>
<td>0xfe00f1</td>
<td></td>
<td>
</td>
<td>
Any, coin lockout 1 sinks current
</td>
</tr>

<tr>
<td>REG_SETCL2</td>
<td>0x3800e7</td>
<td>0xfe00f1</td>
<td></td>
<td>
</td>
<td>
Any, coin lockout 2 sinks current
</td>
</tr>
</table><br>

<p>
System registers
</p>
<table>
<tr><th>Name</th><th>Address</th><th>Mask</th><th>Write</th></tr>
<tr><td>REG_NOSHADOW</td><td>0x3a0001</td><td>0xfe0001</td><td>Normal video output</td></tr>
<tr><td>REG_SHADOW</td><td>0x3a0011</td><td>0xfe0001</td><td>Darken video output</td></tr>
<tr><td>REG_SWPBIOS</td><td>0x3a0003</td><td>0xfe0001</td><td>BIOS vector table</td></tr>
<tr><td>REG_SWPROM</td><td>0x3a0013</td><td>0xfe0001</td><td>Use the cart's vector table</td></tr>
<tr><td>REG_CRDUNLOCK1</td><td>0x3a0005</td><td>0xfe0001</td><td>Enable writes to memory card (unused in CD systems)</td></tr>
<tr><td>REG_CRDLOCK1</td><td>0x3a0015</td><td>0xfe0001</td><td>Disable writes to memory card (unused in CD systems)</td></tr>
<tr><td>REG_CRDLOCK2</td><td>0x3a0007</td><td>0xfe0001</td><td>Disable writes to memory card (unused in CD systems)</td></tr>
<tr><td>REG_CRDUNLOCK2</td><td>0x3a0017</td><td>0xfe0001</td><td>Enable writes to memory card (unused in CD systems)</td></tr>
<tr><td>REG_CRDREGSEL</td><td>0x3a0009</td><td>0xfe0001</td><td>Enable "Register select" for memory card</td></tr>
<tr><td>REG_CRDNORMAL</td><td>0x3a0019</td><td>0xfe0001</td><td>Disable "Register select" for memory card</td></tr>
<tr><td>REG_BRDFIX</td><td>0x3a000b</td><td>0xfe0001</td><td>Use the embedded SFIX ROM and SM1 ROM</td></tr>
<tr><td>REG_CRTFIX</td><td>0x3a001b</td><td>0xfe0001</td><td>Use the cart's S ROM and M1 ROM</td></tr>
<tr><td>REG_SRAMLOCK</td><td>0x3a000d</td><td>0xfe0001</td><td>Write-protects backup RAM (MVS)</td></tr>
<tr><td>REG_SRAMUNLOCK</td><td>0x3a001d</td><td>0xfe0001</td><td>Unprotects backup RAM (MVS)</td></tr>
<tr><td>REG_PALBANK1</td><td>0x3a000f</td><td>0xfe0001</td><td>Use palette bank 1</td></tr>
<tr><td>REG_PALBANK0</td><td>0x3a001f</td><td>0xfe0001</td><td>Use palette bank 0</td></tr>
</table><br>

<p>
Video registers
</p>
<table>
<tr><th>Name</th><th>Address</th><th>Mask</th><th>Read</th><th>Write</th></tr>
<tr><td>REG_VRAMADDR</td><td>0x3c0000</td><td>0xfe0001</td><td>Read from VRAM (address doesn't change)</td><td>Sets VRAM address</td></tr>
<tr><td>REG_VRAMRW</td><td>0x3c0002</td><td>0xfe0001</td><td>Read from VRAM (address doesn't change)</td><td>Write to VRAM (modulo is applied after)</td></tr>
<tr><td>REG_VRAMMOD</td><td>0x3c0004</td><td>0xfe0001</td><td>Reads VRAM address modulo</td><td>Sets VRAM address modulo</td></tr>
<tr><td>REG_LSPCMODE</td><td>0x3c0006</td><td>0xfe0001</td>
<td>
b15~b7: Raster line counter<br>
b6~b4: 0<br>
b3: [1]50Hz, [0]60Hz (LSPC2 only)<br>
b2~b0: Auto animation counter
</td>
<td>
b15~b8: Auto animation speed (in frames)<br>
b7~b5: Timer interrupt mode<br>
b4: Timer interrupt enable<br>
b3: Disable auto animation<br>
b2~b0: Unused
</td></tr>
<tr><td>REG_TIMERHIGH</td><td>0x3c0008</td><td>0xfe0001</td><td>Like REG_VRAMADDR.</td><td>16 highest bits of the timer reload value.</td></tr>
<tr><td>REG_TIMERLOW</td><td>0x3c000a</td><td>0xfe0001</td><td>Like REG_VRAMRW.</td><td>16 lowest bits of the timer reload value.</td></tr>
<tr><td>REG_IRQACK</td><td>0x3c000c</td><td>0xfe0001</td><td>Like REG_VRAMMOD.</td>
<td>
Interrupt acknowledge<br>
b7~b3: Unused<br>
b2: Ack VBlank<br>
b1: Ack HBlank<br>
b0: Ack IRQ3
</td></tr>
<tr><td>REG_TIMERSTOP</td><td>0x3c000e</td><td>0xfe0001</td><td>Like REG_LSPCMODE.</td><td>b0: [1]Stops timer counter during first and last 16 lines (32 total) when in PAL mode.</td></tr>
</table><br>

<p>
<br><a href="../../emu.htm">返回上一頁</a>
</p>

</div>
</div>
</div>
</body>
</html>
